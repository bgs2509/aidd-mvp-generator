# Найденные проблемы фреймворка AIDD-MVP Generator

> **Дата**: 2025-12-22
> **Контекст**: Выполнение команды `/init` для проекта `fastapi-crud-aidd-generated`
> **Версия фреймворка**: Текущая (git submodule)

---

## Issue #1: Отсутствует BOOTSTRAP_READY в шаблоне pipeline-state

### Описание

В шаблоне `.aidd/templates/documents/pipeline-state-template.json` отсутствуют ворота `BOOTSTRAP_READY`, хотя они описаны в документации:

- `.aidd/.claude/commands/init.md` (строки 139-159)
- `.aidd/workflow.md` (Этап 0: Bootstrap)

### Текущее состояние шаблона

```json
{
  "gates": {
    "PRD_READY": { ... },      // ← Начинается с этапа 1
    "RESEARCH_DONE": { ... },
    ...
  }
}
```

### Ожидаемое состояние

```json
{
  "gates": {
    "BOOTSTRAP_READY": {       // ← Этап 0 должен быть первым
      "passed": false,
      "passed_at": null,
      "checks": {
        "git": null,
        "framework": null,
        "python": null,
        "docker": null
      }
    },
    "PRD_READY": { ... },
    ...
  }
}
```

### Затронутые файлы

| Файл | Проблема |
|------|----------|
| `.aidd/templates/documents/pipeline-state-template.json` | Отсутствует `BOOTSTRAP_READY` |

### Рекомендация

Добавить в шаблон `pipeline-state-template.json` секцию `BOOTSTRAP_READY` как первые ворота в объекте `gates`.

### Приоритет

**Средний** — не блокирует работу, но нарушает консистентность документации с реализацией.

---

## Issue #2: Несогласованность current_stage в шаблоне

### Описание

**Файл**: `.aidd/templates/documents/pipeline-state-template.json`

В шаблоне значение `current_stage` установлено в `1`, хотя после `/init` должно быть `0` (Bootstrap выполнен, готовы к этапу 1).

### Текущее состояние

```json
{
  "current_stage": 1,  // ← Указывает на этап ИДЕЯ, хотя PRD ещё не создан
}
```

### Ожидаемое

```json
{
  "current_stage": 0,  // ← Bootstrap выполнен, следующий — этап 1
}
```

### Рекомендация

Изменить значение по умолчанию на `0` или добавить логику автоматического инкремента при прохождении ворот.

### Приоритет

**Низкий** — косметическая проблема, не влияет на функциональность.

---

## Issue #3: /init не проверяет лишние файлы в проекте

### Описание

**Файл**: `.aidd/.claude/commands/init.md`

Команда `/init` не проверяет наличие лишних файлов, созданных до подключения фреймворка (например, через `uv init` или `poetry init`).

### Проблема

При подключении `.aidd` к существующему проекту могут остаться файлы, которые:
- Конфликтуют с требованиями фреймворка (например, `requires-python >= 3.13` вместо `>= 3.11`)
- Не нужны для работы (заглушки типа `main.py` с "Hello from...")
- Требуют адаптации к структуре фреймворка

### Типичные лишние файлы

| Файл | Проблема | Действие |
|------|----------|----------|
| `main.py` | Заглушка "Hello from..." | Удалить (код будет в `services/`) |
| `pyproject.toml` | `requires-python >= 3.13` | Отредактировать на `>= 3.11` |
| `.python-version` | Может указывать на несовместимую версию | Привести в соответствие |
| `uv.lock` / `poetry.lock` | Пересоздать после изменений | `uv lock` или `poetry lock` |

### Рекомендация

Добавить в `/init` этап проверки лишних файлов:

1. **Обнаружение** — сканировать корень проекта на наличие `main.py`, `app.py`, `__main__.py`
2. **Проверка pyproject.toml** — если существует, проверить `requires-python >= 3.11`
3. **Информирование** — показать пользователю список найденных файлов
4. **Рекомендация** — предложить удалить или отредактировать

### Пример вывода

```
┌─────────────────────────────────────────────────────────────────┐
│  ⚠️  Обнаружены файлы, требующие внимания:                       │
├─────────────────────────────────────────────────────────────────┤
│  • main.py — заглушка, рекомендуется удалить                    │
│  • pyproject.toml — requires-python >= 3.13, требуется >= 3.11  │
│  • .python-version — 3.13, рекомендуется 3.12 или 3.11          │
└─────────────────────────────────────────────────────────────────┘
```

### Приоритет

**Средний** — улучшает пользовательский опыт и предотвращает ошибки конфигурации.

---

## Резюме

| # | Issue | Файл | Приоритет | Статус |
|---|-------|------|-----------|--------|
| 1 | BOOTSTRAP_READY отсутствует в шаблоне | `pipeline-state-template.json` | Средний | Открыт |
| 2 | current_stage = 1 вместо 0 | `pipeline-state-template.json` | Низкий | Открыт |
| 3 | /init не проверяет лишние файлы | `init.md` | Средний | Открыт |

---

*Файл создан автоматически во время выполнения `/init`*
