# CLAUDE.md — Главная точка входа для AI-агентов

> **Назначение**: Этот файл — первый документ, который AI-агент должен прочитать.
> Содержит обзор фреймворка, правила работы и порядок чтения документации.
>
> **Философия**: VERIFY BEFORE ACT — Проверяй перед действием.

---

## Обзор фреймворка AIDD-MVP Generator

**AIDD-MVP Generator** — фреймворк для быстрой генерации production-ready MVP проектов,
объединяющий методологию AI-Driven Development (AIDD) с архитектурными шаблонами.

### Ключевые характеристики

| Параметр | Значение |
|----------|----------|
| Уровень зрелости | **Level 2 (MVP)** — всегда |
| Покрытие тестами | ≥75% |
| Время генерации | ~10 минут |
| Архитектура | DDD/Hexagonal, HTTP-only доступ к данным |
| Качественные ворота | 8 обязательных gates |

### Два режима работы

| Режим | Команда | Описание |
|-------|---------|----------|
| **CREATE** | `/idea "описание"` | Создание нового MVP проекта с нуля |
| **FEATURE** | `/idea "описание фичи"` | Добавление функционала в существующий проект |

---

## Порядок чтения документации

AI-агент ДОЛЖЕН читать документы в следующем порядке:

```
1. CLAUDE.md (этот файл)     ← Обзор и правила
        │
        ▼
2. conventions.md            ← Соглашения о коде
        │
        ▼
3. workflow.md               ← Процесс разработки (8 этапов)
        │
        ▼
4. .claude/agents/{role}.md  ← Инструкции для текущей роли
        │
        ▼
5. roles/{role}/*.md         ← Детальные инструкции функций
        │
        ▼
6. knowledge/{topic}/        ← База знаний по теме
```

---

## Структура фреймворка

```
aidd-mvp-generator/
│
├── CLAUDE.md              ← ВЫ ЗДЕСЬ — точка входа
├── conventions.md         ← Соглашения о коде и стиле
├── workflow.md            ← Описание 8-этапного процесса
├── README.md              ← Общая документация проекта
│
├── .claude/               ← Интеграция Claude Code
│   ├── settings.json      ← Permissions и hooks
│   ├── agents/            ← Subagents для Task tool (7 ролей)
│   │   ├── analyst.md
│   │   ├── researcher.md
│   │   ├── architect.md
│   │   ├── implementer.md
│   │   ├── reviewer.md
│   │   ├── qa.md
│   │   └── validator.md
│   │
│   └── commands/          ← 9 slash-команд
│       ├── idea.md        → /idea
│       ├── research.md    → /research
│       ├── plan.md        → /plan
│       ├── feature-plan.md → /feature-plan
│       ├── generate.md    → /generate
│       ├── review.md      → /review
│       ├── test.md        → /test
│       ├── validate.md    → /validate
│       └── deploy.md      → /deploy
│
├── roles/                 ← Детальные инструкции по ролям
│   ├── analyst/           ← Аналитик: PRD, требования
│   ├── researcher/        ← Исследователь: анализ кода
│   ├── architect/         ← Архитектор: проектирование
│   ├── implementer/       ← Реализатор: генерация кода
│   ├── reviewer/          ← Ревьюер: код-ревью
│   ├── qa/                ← QA: тестирование
│   └── validator/         ← Валидатор: проверка ворот
│
├── knowledge/             ← База знаний
│   ├── architecture/      ← Архитектурные принципы
│   ├── services/          ← FastAPI, Aiogram, Workers
│   ├── integrations/      ← HTTP, Redis
│   ├── infrastructure/    ← Docker, Nginx, CI/CD
│   └── quality/           ← Тестирование, логирование
│
├── templates/             ← Шаблоны для генерации
│   ├── services/          ← Шаблоны 5 типов сервисов
│   ├── shared/            ← Общие компоненты
│   └── infrastructure/    ← Docker, Nginx, GitHub Actions
│
└── docs/                  ← Шаблоны документов
    ├── prd/               ← Шаблон PRD
    ├── architecture/      ← Шаблон архитектуры
    ├── plans/             ← Шаблон плана фичи
    └── reports/           ← Шаблоны отчётов
```

---

## Критические правила

### 1. Архитектурные принципы

| Принцип | Правило |
|---------|---------|
| **HTTP-only** | Бизнес-сервисы НИКОГДА не обращаются к БД напрямую |
| **DDD/Hexagonal** | Разделение на api/application/domain/infrastructure |
| **Async-First** | Все I/O операции используют async/await |
| **Типобезопасность** | Полные type hints для всех функций |

### 2. Правила верификации (VERIFY BEFORE ACT)

```
┌─────────────────────────────────────────────────────────────────┐
│  ПЕРЕД ЛЮБЫМ ДЕЙСТВИЕМ AI ОБЯЗАН:                               │
├─────────────────────────────────────────────────────────────────┤
│  1. СОЗДАНИЕ ФАЙЛА  → Проверить, что файл НЕ существует         │
│  2. РЕДАКТИРОВАНИЕ  → Сначала прочитать текущее содержимое      │
│  3. УДАЛЕНИЕ        → Проверить все зависимости и ссылки        │
│  4. ДОБАВЛЕНИЕ ССЫЛКИ → Проверить, что цель существует          │
│  5. НАПИСАНИЕ КОДА  → Проверить нет ли похожего кода (DRY)      │
│  6. ДОБАВЛЕНИЕ ФИЧИ → Проверить, что это нужно СЕЙЧАС (YAGNI)   │
└─────────────────────────────────────────────────────────────────┘

НИКОГДА НЕ ПРЕДПОЛАГАТЬ → ВСЕГДА ПРОВЕРЯТЬ → ЗАТЕМ ДЕЙСТВОВАТЬ
```

### 3. Качественные ворота

> **Примечание**: Качественные ворота — это концепция фреймворка, а НЕ встроенная функция Claude Code.
> Проверка ворот реализуется через инструкции в промптах команд.

AI-агент НЕ МОЖЕТ перейти к следующему этапу без прохождения ворот:

| Этап | Ворота | Критерии |
|------|--------|----------|
| 1. Идея | `PRD_READY` | PRD заполнен, нет блокирующих вопросов |
| 2. Исследование | `RESEARCH_DONE` | Код проанализирован, паттерны выявлены |
| 3. Архитектура | `PLAN_APPROVED` | План утверждён пользователем |
| 4. Реализация | `IMPLEMENT_OK` | Код написан, тесты проходят |
| 5. Ревью | `REVIEW_OK` | Код соответствует стандартам |
| 6. QA | `QA_PASSED` | Coverage ≥75%, нет критических багов |
| 7. Валидация | `ALL_GATES_PASSED` | Все артефакты проверены |
| 8. Деплой | `DEPLOYED` | Приложение запущено |

---

## Типы сервисов

Фреймворк поддерживает генерацию 5 типов сервисов:

| Тип | Шаблон | Порт | Описание |
|-----|--------|------|----------|
| **Business API** | `fastapi_business_api/` | 8000-8099 | REST API на FastAPI |
| **Business Bot** | `aiogram_bot/` | — | Telegram бот на Aiogram |
| **Background Worker** | `asyncio_worker/` | — | Фоновые задачи на AsyncIO |
| **Data API PostgreSQL** | `postgres_data_api/` | 8001 | CRUD для PostgreSQL |
| **Data API MongoDB** | `mongo_data_api/` | 8002 | CRUD для MongoDB |

---

## Именование

### Сервисы
```
{контекст}_{домен}_{тип}

Примеры:
- finance_lending_api      — API для кредитования
- finance_lending_bot      — Telegram бот для кредитования
- finance_lending_worker   — Фоновый воркер
- finance_lending_data     — Data API (PostgreSQL)
```

### Файлы
```
- snake_case для Python файлов: user_service.py
- kebab-case для конфигов: docker-compose.yml
- Docstrings на русском языке в Google-стиле
```

---

## Быстрый старт

### Создание нового MVP

```bash
# 1. Запустить Claude Code в директории проекта
claude

# 2. Описать идею
/idea "Создать сервис бронирования столиков в ресторанах"

# 3. Следовать процессу (8 этапов)
# Каждый этап запускается соответствующей командой:
# /idea → /research → /plan → /generate → /review → /test → /validate → /deploy
```

### Добавление фичи

```bash
# 1. Описать фичу
/idea "Добавить систему уведомлений по email"

# 2. Следовать процессу для фичи:
# /idea → /research → /feature-plan → /generate → /review → /test → /validate → /deploy
```

---

## Связанные документы

| Документ | Описание |
|----------|----------|
| [conventions.md](conventions.md) | Соглашения о коде и стиле |
| [workflow.md](workflow.md) | 8-этапный процесс разработки |
| [.claude/agents/](/.claude/agents/) | Определения AI-ролей |
| [knowledge/architecture/](knowledge/architecture/) | Архитектурные принципы |

---

**Версия документа**: 1.0
**Создан**: 2025-12-19
**Назначение**: Главная точка входа для AI-агентов AIDD-MVP Generator
