---
allowed-tools: Read(*), Glob(*), Grep(*), Edit(**/*.md), Write(**/*.md)
description: Создать план реализации новой фичи в существующем проекте
---

# Команда: /feature-plan

> Запускает Архитектора для планирования фичи (режим FEATURE).

---

## Синтаксис

```bash
/feature-plan
```

---

## Описание

Команда `/feature-plan` создаёт план реализации новой функции
в существующем проекте. Учитывает текущую архитектуру и паттерны.

---

## Агент

**Архитектор** (`.claude/agents/architect.md`)

---

## Режимы

Только **FEATURE** — для существующих проектов.

Для нового проекта используйте `/plan`.

---

## Предусловия

| Ворота | Требование |
|--------|------------|
| `PRD_READY` | FEATURE_PRD документ существует |
| `RESEARCH_DONE` | Код проанализирован |

### Алгоритм проверки

```
1. Проверить существование .pipeline-state.json
2. Если файл отсутствует:
   ❌ Пайплайн не инициализирован
   → Сначала выполните /idea
3. Проверить mode == "FEATURE"
4. Если mode != "FEATURE":
   ⚠️ Режим CREATE — используйте /plan вместо /feature-plan
5. Проверить gates.PRD_READY.passed == true
6. Если ворота не пройдены:
   ❌ Ворота PRD_READY не пройдены
   → Сначала выполните /idea
7. Проверить gates.RESEARCH_DONE.passed == true
8. Если ворота не пройдены:
   ❌ Ворота RESEARCH_DONE не пройдены
   → Сначала выполните /research
9. Продолжить выполнение
```

---

## Выходные артефакты (в целевом проекте)

| Артефакт | Путь |
|----------|------|
| План фичи | `ai-docs/docs/plans/{feature}-plan.md` |

---

## Качественные ворота

### PLAN_APPROVED

| Критерий | Описание |
|----------|----------|
| Интеграция | Точки интеграции определены |
| Изменения | Необходимые изменения описаны |
| Риски | Потенциальные риски учтены |
| **Утверждение** | План утверждён пользователем |

**ВАЖНО**: Требуется явное подтверждение от пользователя!

---

## Примеры использования

```bash
# После /research (для фичи)
/feature-plan
```

---

## Следующий шаг

После прохождения ворот `PLAN_APPROVED`:

```bash
/generate
```
