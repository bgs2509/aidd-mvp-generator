# Функция: Создание QA Report

> **Назначение**: Формирование финального отчёта тестирования.

---

## Цель

Создать структурированный отчёт о результатах тестирования,
готовый для передачи на этап валидации.

---

## Структура отчёта

```markdown
# QA Report: {Название проекта}

**Версия**: 1.0
**Дата**: {YYYY-MM-DD}
**QA**: AI Agent (QA)
**Статус**: PASSED / FAILED / PASSED_WITH_ISSUES

---

## 1. Обзор тестирования

### 1.1 Scope

| Параметр | Значение |
|----------|----------|
| Тестируемые сервисы | {список} |
| Тестовых сценариев | {N} |
| Выполнено тестов | {N} |
| Период тестирования | {дата} |

### 1.2 Окружение

| Параметр | Значение |
|----------|----------|
| Python | 3.11.x |
| pytest | 7.x.x |
| Docker | 24.x |
| CI | GitHub Actions |

---

## 2. Результаты тестов

### 2.1 Сводка

| Тип теста | Всего | Passed | Failed | Skipped | % Passed |
|-----------|-------|--------|--------|---------|----------|
| Unit | {N} | {N} | {N} | {N} | {N}% |
| Integration | {N} | {N} | {N} | {N} | {N}% |
| **Итого** | **{N}** | **{N}** | **{N}** | **{N}** | **{N}%** |

### 2.2 Результаты по сервисам

#### {context}_api

| Метрика | Значение |
|---------|----------|
| Unit тесты | {N}/{N} passed |
| Integration тесты | {N}/{N} passed |
| Покрытие кода | {N}% |
| Время выполнения | {N}s |

#### {context}_data

| Метрика | Значение |
|---------|----------|
| Unit тесты | {N}/{N} passed |
| Integration тесты | {N}/{N} passed |
| Покрытие кода | {N}% |
| Время выполнения | {N}s |

---

## 3. Покрытие кода

### 3.1 Сводка по покрытию

| Сервис | Statements | Missing | Coverage | Статус |
|--------|------------|---------|----------|--------|
| {context}_api | {N} | {N} | {N}% | ✓/✗ |
| {context}_data | {N} | {N} | {N}% | ✓/✗ |
| **Общее** | **{N}** | **{N}** | **{N}%** | **✓/✗** |

### 3.2 Модули с низким покрытием

| Модуль | Покрытие | Причина | Действие |
|--------|----------|---------|----------|
| {модуль} | {N}% | {причина} | {действие} |

---

## 4. Покрытие требований

### 4.1 Сводка

| Приоритет | Всего | Покрыто | % | Статус |
|-----------|-------|---------|---|--------|
| Must | {N} | {N} | {N}% | ✓/✗ |
| Should | {N} | {N} | {N}% | ✓/✗ |
| Could | {N} | {N} | {N}% | — |

### 4.2 RTM статус

| Req ID | Описание | Тесты | Результат |
|--------|----------|-------|-----------|
| FR-001 | {описание} | TS-001, TS-002 | ✓ PASSED |
| FR-002 | {описание} | TS-003 | ✓ PASSED |
| NF-001 | {описание} | TS-010 | ✓ PASSED |

---

## 5. Найденные дефекты

### 5.1 Критические (Blocker)

| # | Описание | Тест | Сервис | Статус |
|---|----------|------|--------|--------|
| — | Нет критических дефектов | — | — | — |

### 5.2 Важные (Major)

| # | Описание | Тест | Сервис | Статус |
|---|----------|------|--------|--------|
| 1 | {описание} | {тест} | {сервис} | Open/Fixed |

### 5.3 Незначительные (Minor)

| # | Описание | Тест | Сервис | Статус |
|---|----------|------|--------|--------|
| 1 | {описание} | {тест} | {сервис} | Open/Fixed |

---

## 6. Автоматические проверки

### 6.1 CI Pipeline

| Шаг | Статус | Время | Комментарий |
|-----|--------|-------|-------------|
| Build | ✓ PASSED | 45s | — |
| Unit Tests | ✓ PASSED | 30s | — |
| Integration Tests | ✓ PASSED | 60s | — |
| Coverage Check | ✓ PASSED | 5s | 84% ≥ 75% |
| Lint | ✓ PASSED | 10s | — |

### 6.2 Качество кода

| Проверка | Результат | Ошибок |
|----------|-----------|--------|
| ruff check | PASSED | 0 |
| ruff format | PASSED | 0 |
| mypy | PASSED | 0 |

---

## 7. Метрики качества

### 7.1 Сводка метрик

| Метрика | Значение | Порог | Статус |
|---------|----------|-------|--------|
| Code Coverage | {N}% | ≥75% | ✓/✗ |
| Test Pass Rate | {N}% | 100% | ✓/✗ |
| Must Coverage | {N}% | 100% | ✓/✗ |
| Critical Defects | {N} | 0 | ✓/✗ |

### 7.2 Тренды (если применимо)

| Метрика | Предыдущий | Текущий | Изменение |
|---------|------------|---------|-----------|
| Coverage | {N}% | {N}% | +{N}% |
| Test Count | {N} | {N} | +{N} |

---

## 8. Рекомендации

### 8.1 Обязательные действия

1. {Действие 1 — если есть failed тесты}
2. {Действие 2 — если coverage ниже порога}

### 8.2 Рекомендуемые улучшения

1. {Улучшение 1}
2. {Улучшение 2}

---

## 9. Заключение

### Общий статус: {PASSED / FAILED / PASSED_WITH_ISSUES}

### Резюме

{Краткое резюме результатов тестирования}

### Качественные ворота

- [ ] Все тесты проходят (100% pass rate)
- [ ] Code coverage ≥75%
- [ ] Must требования покрыты на 100%
- [ ] Нет критических дефектов
- [ ] CI pipeline проходит

---

## 10. Приложения

### A. Полный список тестов

{Ссылка на файл или развёрнутый список}

### B. HTML отчёт о покрытии

{Путь к htmlcov/}

### C. CI логи

{Ссылка на CI run}
```

---

## Правила формирования отчёта

### 1. Статус QA

```
PASSED:
- 100% тестов проходят
- Coverage ≥75%
- Все Must требования покрыты
- Нет критических дефектов

PASSED_WITH_ISSUES:
- Все тесты проходят
- Coverage ≥75%
- Есть незначительные дефекты
- Документированные проблемы

FAILED:
- Есть падающие тесты
- Coverage <75%
- Есть критические дефекты
- Must требования не покрыты
```

### 2. Классификация дефектов

```
Blocker:
- Приложение не запускается
- Критическая функциональность не работает
- Data loss

Major:
- Важная функция работает некорректно
- Ошибки в бизнес-логике
- Performance проблемы

Minor:
- Косметические проблемы
- UX неудобства
- Edge cases
```

---

## Путь сохранения

```
ai-docs/docs/reports/qa-report.md

Или с датой:
ai-docs/docs/reports/{YYYY-MM-DD}-qa-report.md
```

---

## Качественные ворота: QA_PASSED

### Критерии прохождения

- [ ] Статус QA: PASSED или PASSED_WITH_ISSUES
- [ ] 100% тестов проходят
- [ ] Coverage ≥75%
- [ ] 100% Must требований покрыто
- [ ] Нет критических дефектов
- [ ] CI pipeline проходит
- [ ] RTM обновлена

---

## Источники

| Документ | Описание |
|----------|----------|
| `roles/qa/test-scenarios.md` | Тестовые сценарии |
| `roles/qa/test-execution.md` | Выполнение тестов |
| `roles/qa/coverage-verification.md` | Верификация покрытия |
| `docs/reports/qa-template.md` | Шаблон отчёта |
