# Функция: Формирование PRD

> **Назначение**: Создание финального PRD документа.

---

## Цель

Собрать все требования в структурированный PRD документ,
готовый для передачи на этап архитектуры.

---

## Структура PRD (11 разделов)

```markdown
# PRD: {Название проекта}

**Версия**: 1.0
**Дата**: {YYYY-MM-DD}
**Автор**: AI Agent (Аналитик)
**Статус**: Draft | Review | Approved

---

## 1. Обзор
### 1.1 Проблема
### 1.2 Решение
### 1.3 Целевая аудитория
### 1.4 Scope MVP

## 2. Функциональные требования
| ID | Название | Описание | Приоритет | Критерий приёмки |

## 3. User Stories
### US-001: {Название}

## 4. Пайплайны
### 4.0 Тип изменений
### 4.1 Бизнес-пайплайн
### 4.2 Data Pipeline
### 4.3 Интеграционный пайплайн
### 4.4 Влияние на существующие пайплайны

## 5. UI/UX требования
| ID | Название | Описание | Приоритет |

## 6. Нефункциональные требования
| ID | Название | Описание | Метрика |

## 7. Технические ограничения
## 8. Допущения и риски
## 9. Открытые вопросы
## 10. Глоссарий
## 11. История изменений

## Качественные ворота
### PRD_READY Checklist
```

---

## Правила формирования

### 1. Обзор (Секция 1)

```
1.1 Проблема:
- Описать боль пользователя
- Почему текущие решения не подходят

1.2 Решение:
- Как проект решает проблему
- Ключевые преимущества

1.3 Целевая аудитория:
- Основные пользователи
- Их характеристики

1.4 Scope MVP:
- Что ВХОДИТ в MVP
- Что НЕ ВХОДИТ (осознанно отложено)
```

### 2. Функциональные требования (Секция 2)

```
Каждое требование:
- Уникальный ID (FR-001, FR-002, ...)
- Краткое название
- Детальное описание
- Приоритет (Must/Should/Could)
- Измеримый критерий приёмки
```

### 3. Пайплайны (Секция 4)

```
4.0 Тип изменений:
- Режим: CREATE (новый) / FEATURE (изменение)
- Затрагиваемые пайплайны

4.1 Бизнес-пайплайн:
- Основной flow операций
- Состояния сущностей и переходы
- Условия переходов между этапами

4.2 Data Pipeline:
- Диаграмма потока данных (ASCII)
- Таблица: источник → назначение → данные → формат
- Трансформации данных

4.3 Интеграционный пайплайн:
- Карта сервисов (ASCII)
- Точки интеграции (INT-001, INT-002, ...)
- Контракты API (Request/Response/Errors)

4.4 Влияние на существующие пайплайны:
- Для CREATE: "Новая система"
- Для FEATURE: таблица изменений, breaking changes
```

### 4. Нефункциональные требования (Секция 6)

```
Стандартный набор для MVP:
- NF-001: Время отклика (<500ms)
- NF-002: Доступность (99%)
- NF-003: Покрытие тестами (≥75%)
- NF-004: Безопасность (авторизация, валидация)
```

### 5. Открытые вопросы (Секция 9)

```
Вопросы, требующие уточнения.
Статусы:
- Open: Требует решения
- Resolved: Решён (указать решение)

Блокирующие вопросы ДОЛЖНЫ быть решены
до прохождения ворот PRD_READY.
```

### 6. История изменений (Секция 11)

```
Версионность документа.
Фиксировать все значимые изменения PRD.
```

---

## Путь сохранения (в целевом проекте)

```
ai-docs/docs/prd/{project-name}-prd.md

Примеры:
- ai-docs/docs/prd/booking-restaurant-prd.md
- ai-docs/docs/prd/personal-finance-prd.md
```

Для режима FEATURE:
```
ai-docs/docs/prd/{feature-name}-feature-prd.md
```

---

## Чек-лист PRD_READY

- [ ] Секция 1 (Обзор) заполнена
- [ ] Секция 2 (FR) содержит все требования
- [ ] Секция 3 (User Stories) связаны с FR
- [ ] Секция 4 (Пайплайны) заполнена:
  - [ ] Бизнес-пайплайн описан (flow, состояния)
  - [ ] Data Pipeline описан (диаграмма, трансформации)
  - [ ] Интеграционный пайплайн описан (карта, контракты)
  - [ ] Влияние на существующие пайплайны указано
- [ ] Секция 5 (UI/UX) заполнена (если применимо)
- [ ] Секция 6 (NF) содержит стандартные требования
- [ ] Секция 7 (Технические ограничения) заполнена
- [ ] Секция 8 (Допущения и риски) заполнена
- [ ] Секция 9 (Вопросы) не имеет Open блокеров
- [ ] Все ID уникальны (FR-*, NF-*, UI-*, INT-*)
- [ ] Все Must-требования имеют критерии приёмки
- [ ] Документ сохранён в `ai-docs/docs/prd/` (целевой проект)

---

## Источники

| Документ | Описание |
|----------|----------|
| `.ai-framework/docs/workflows/analyst-workflow.md` | Workflow аналитика |
| `.ai-framework/docs/reference/aidd-roles-reference.md` | Справочник ролей |
| `templates/documents/prd-template.md` | Шаблон PRD |
