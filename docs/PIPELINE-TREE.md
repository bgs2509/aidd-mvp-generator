# PIPELINE-TREE.md — Дерево пайплайнов AIDD-MVP

> **Назначение**: Полная карта всех пайплайнов фреймворка.
> Для каждого пайплайна указаны: команда, агент, ворота, артефакты, источники файлов.

---

## Визуальное дерево пайплайнов

```
┌─────────────────────────────────────────────────────────────────────────────────┐
│                          AIDD-MVP PIPELINE TREE                                  │
├─────────────────────────────────────────────────────────────────────────────────┤
│                                                                                  │
│  ┌──────────────┐                                                                │
│  │   ЭТАП 0     │  Bootstrap Pipeline                                           │
│  │   /init      │  ────────────────────────────────────────────────────────────  │
│  │              │  Инициализация целевого проекта                               │
│  └──────┬───────┘                                                                │
│         │ BOOTSTRAP_READY                                                        │
│         ▼                                                                        │
│  ┌──────────────┐                                                                │
│  │   ЭТАП 1     │  Idea Pipeline                                                │
│  │   /idea      │  ────────────────────────────────────────────────────────────  │
│  │              │  Создание PRD документа                                       │
│  └──────┬───────┘                                                                │
│         │ PRD_READY                                                              │
│         ▼                                                                        │
│  ┌──────────────┐                                                                │
│  │   ЭТАП 2     │  Research Pipeline                                            │
│  │   /research  │  ────────────────────────────────────────────────────────────  │
│  │              │  Исследование и анализ                                        │
│  └──────┬───────┘                                                                │
│         │ RESEARCH_DONE                                                          │
│         ▼                                                                        │
│  ┌──────────────┐                                                                │
│  │   ЭТАП 3     │  Architecture Pipeline                                        │
│  │ /plan или    │  ────────────────────────────────────────────────────────────  │
│  │ /feature-plan│  Проектирование архитектуры                                   │
│  └──────┬───────┘                                                                │
│         │ PLAN_APPROVED (требует подтверждения пользователя)                     │
│         ▼                                                                        │
│  ┌──────────────┐                                                                │
│  │   ЭТАП 4     │  Implementation Pipeline                                       │
│  │   /generate  │  ────────────────────────────────────────────────────────────  │
│  │              │  Генерация кода                                               │
│  └──────┬───────┘                                                                │
│         │ IMPLEMENT_OK                                                           │
│         ▼                                                                        │
│  ┌──────────────┐                                                                │
│  │   ЭТАП 5     │  Review Pipeline                                              │
│  │   /review    │  ────────────────────────────────────────────────────────────  │
│  │              │  Код-ревью                                                    │
│  └──────┬───────┘                                                                │
│         │ REVIEW_OK                                                              │
│         ▼                                                                        │
│  ┌──────────────┐                                                                │
│  │   ЭТАП 6     │  QA Pipeline                                                  │
│  │   /test      │  ────────────────────────────────────────────────────────────  │
│  │              │  Тестирование                                                 │
│  └──────┬───────┘                                                                │
│         │ QA_PASSED                                                              │
│         ▼                                                                        │
│  ┌──────────────┐                                                                │
│  │   ЭТАП 7     │  Validation Pipeline                                          │
│  │   /validate  │  ────────────────────────────────────────────────────────────  │
│  │              │  Валидация всех артефактов                                    │
│  └──────┬───────┘                                                                │
│         │ ALL_GATES_PASSED                                                       │
│         ▼                                                                        │
│  ┌──────────────┐                                                                │
│  │   ЭТАП 8     │  Deploy Pipeline                                              │
│  │   /deploy    │  ────────────────────────────────────────────────────────────  │
│  │              │  Сборка и запуск                                              │
│  └──────┬───────┘                                                                │
│         │ DEPLOYED                                                               │
│         ▼                                                                        │
│    ✅ MVP ГОТОВ                                                                  │
│                                                                                  │
└─────────────────────────────────────────────────────────────────────────────────┘
```

---

## Детальное описание пайплайнов

### Этап 0: Bootstrap Pipeline

| Параметр | Значение |
|----------|----------|
| **Команда** | `/init` (ручной) или авто с `/idea` |
| **Агент** | — (системный) |
| **Предусловия** | — |
| **Качественные ворота** | `BOOTSTRAP_READY` |

#### Проверки

| # | Проверка | Команда/Файл | Критерий |
|---|----------|--------------|----------|
| 1 | Git репозиторий | `git rev-parse --git-dir` | Выход 0 |
| 2 | Фреймворк подключен | `.aidd/CLAUDE.md` | Файл существует |
| 3 | Python версия | `python3 --version` | >= 3.11 |
| 4 | Docker | `docker --version` | Установлен |

#### Действия

| # | Действие | Результат |
|---|----------|-----------|
| 1 | Создать структуру папок | `ai-docs/docs/{prd,architecture,plans,reports}` |
| 2 | Создать состояние пайплайна | `.pipeline-state.json` |
| 3 | Создать CLAUDE.md | `./CLAUDE.md` → ссылка на `.aidd/CLAUDE.md` |

#### Источники файлов

| Файл | Источник | Путь |
|------|----------|------|
| Инструкции команды | Фреймворк | `.aidd/.claude/commands/init.md` |
| CLAUDE.md (шаблон) | Фреймворк | `.aidd/CLAUDE.md` |
| Структура ЦП | Фреймворк | `.aidd/docs/target-project-structure.md` |
| **Результат** | ЦП | `./CLAUDE.md`, `./ai-docs/docs/`, `./.pipeline-state.json` |

---

### Этап 1: Idea Pipeline (PRD)

| Параметр | Значение |
|----------|----------|
| **Команда** | `/idea "описание"` |
| **Агент** | Аналитик |
| **Предусловия** | `BOOTSTRAP_READY` (или авто-bootstrap) |
| **Качественные ворота** | `PRD_READY` |

#### Входные артефакты

| Артефакт | Источник | Путь |
|----------|----------|------|
| Описание идеи | Пользователь | Аргумент команды |
| Шаблон PRD | Фреймворк | `.aidd/templates/documents/prd-template.md` |

#### Выходные артефакты

| Артефакт | Путь в ЦП |
|----------|-----------|
| PRD документ | `ai-docs/docs/prd/{name}-prd.md` |
| Состояние | `.pipeline-state.json` (обновлено) |

#### Источники файлов

| Файл | Источник | Путь |
|------|----------|------|
| Инструкции команды | Фреймворк | `.aidd/.claude/commands/idea.md` |
| Инструкции агента | Фреймворк | `.aidd/.claude/agents/analyst.md` |
| Шаблон PRD | Фреймворк | `.aidd/templates/documents/prd-template.md` |
| Workflow | Фреймворк | `.aidd/workflow.md` |
| **Результат** | ЦП | `ai-docs/docs/prd/{name}-prd.md` |

---

### Этап 2: Research Pipeline

| Параметр | Значение |
|----------|----------|
| **Команда** | `/research` |
| **Агент** | Исследователь |
| **Предусловия** | `PRD_READY` |
| **Качественные ворота** | `RESEARCH_DONE` |

#### Входные артефакты

| Артефакт | Источник | Путь |
|----------|----------|------|
| PRD | ЦП | `ai-docs/docs/prd/{name}-prd.md` |
| Существующий код | ЦП | `services/` (для FEATURE) |

#### Выходные артефакты

| Артефакт | Путь в ЦП |
|----------|-----------|
| Результаты исследования | (в памяти/контексте) |
| Состояние | `.pipeline-state.json` (обновлено) |

#### Источники файлов

| Файл | Источник | Путь |
|------|----------|------|
| Инструкции команды | Фреймворк | `.aidd/.claude/commands/research.md` |
| Инструкции агента | Фреймворк | `.aidd/.claude/agents/researcher.md` |
| Детальные инструкции | Фреймворк | `.aidd/roles/researcher/*.md` |
| PRD | ЦП | `ai-docs/docs/prd/{name}-prd.md` |

---

### Этап 3: Architecture Pipeline

| Параметр | Значение CREATE | Значение FEATURE |
|----------|-----------------|------------------|
| **Команда** | `/plan` | `/feature-plan` |
| **Агент** | Архитектор | Архитектор |
| **Предусловия** | `PRD_READY`, `RESEARCH_DONE` | `PRD_READY`, `RESEARCH_DONE` |
| **Качественные ворота** | `PLAN_APPROVED` | `PLAN_APPROVED` |

#### Входные артефакты

| Артефакт | Источник | Путь |
|----------|----------|------|
| PRD | ЦП | `ai-docs/docs/prd/{name}-prd.md` |
| Результаты исследования | Память | — |
| Шаблон архитектуры | Фреймворк | `.aidd/templates/documents/architecture-template.md` |

#### Выходные артефакты

| Артефакт | Путь в ЦП (CREATE) | Путь в ЦП (FEATURE) |
|----------|-------------------|---------------------|
| План архитектуры | `ai-docs/docs/architecture/{name}-plan.md` | — |
| План фичи | — | `ai-docs/docs/plans/{feature}-plan.md` |

#### Источники файлов

| Файл | Источник | Путь |
|------|----------|------|
| Инструкции команды | Фреймворк | `.aidd/.claude/commands/plan.md` или `feature-plan.md` |
| Инструкции агента | Фреймворк | `.aidd/.claude/agents/architect.md` |
| Детальные инструкции | Фреймворк | `.aidd/roles/architect/*.md` |
| База знаний | Фреймворк | `.aidd/knowledge/architecture/*.md` |
| **Результат** | ЦП | `ai-docs/docs/architecture/` или `ai-docs/docs/plans/` |

---

### Этап 4: Implementation Pipeline

| Параметр | Значение |
|----------|----------|
| **Команда** | `/generate` |
| **Агент** | Реализатор |
| **Предусловия** | `PLAN_APPROVED` |
| **Качественные ворота** | `IMPLEMENT_OK` |

#### Входные артефакты

| Артефакт | Источник | Путь |
|----------|----------|------|
| План | ЦП | `ai-docs/docs/architecture/{name}-plan.md` |
| Шаблоны сервисов | Фреймворк | `.aidd/templates/services/` |
| Шаблоны инфраструктуры | Фреймворк | `.aidd/templates/infrastructure/` |
| Shared компоненты | Фреймворк | `.aidd/templates/shared/` |

#### Выходные артефакты

| Артефакт | Путь в ЦП |
|----------|-----------|
| Business API | `services/{name}_api/` |
| Data API | `services/{name}_data/` |
| Telegram Bot | `services/{name}_bot/` |
| Background Worker | `services/{name}_worker/` |
| Docker Compose | `docker-compose.yml` |
| Makefile | `Makefile` |
| Nginx | `nginx/` |

#### Источники файлов

| Файл | Источник | Путь |
|------|----------|------|
| Инструкции команды | Фреймворк | `.aidd/.claude/commands/generate.md` |
| Инструкции агента | Фреймворк | `.aidd/.claude/agents/implementer.md` |
| Детальные инструкции | Фреймворк | `.aidd/roles/implementer/*.md` |
| Шаблон FastAPI | Фреймворк | `.aidd/templates/services/fastapi_business_api/` |
| Шаблон Data API | Фреймворк | `.aidd/templates/services/postgres_data_api/` |
| Шаблон Bot | Фреймворк | `.aidd/templates/services/aiogram_bot/` |
| Шаблон Worker | Фреймворк | `.aidd/templates/services/asyncio_worker/` |
| База знаний | Фреймворк | `.aidd/knowledge/services/*.md` |
| Conventions | Фреймворк | `.aidd/conventions.md` |
| **Результат** | ЦП | `services/`, `docker-compose.yml`, `Makefile` |

---

### Этап 5: Review Pipeline

| Параметр | Значение |
|----------|----------|
| **Команда** | `/review` |
| **Агент** | Ревьюер |
| **Предусловия** | `IMPLEMENT_OK` |
| **Качественные ворота** | `REVIEW_OK` |

#### Входные артефакты

| Артефакт | Источник | Путь |
|----------|----------|------|
| Код сервисов | ЦП | `services/` |
| План | ЦП | `ai-docs/docs/architecture/{name}-plan.md` |
| Conventions | Фреймворк | `.aidd/conventions.md` |

#### Выходные артефакты

| Артефакт | Путь в ЦП |
|----------|-----------|
| Отчёт ревью | `ai-docs/docs/reports/review-report.md` |

#### Источники файлов

| Файл | Источник | Путь |
|------|----------|------|
| Инструкции команды | Фреймворк | `.aidd/.claude/commands/review.md` |
| Инструкции агента | Фреймворк | `.aidd/.claude/agents/reviewer.md` |
| Детальные инструкции | Фреймворк | `.aidd/roles/reviewer/*.md` |
| Conventions | Фреймворк | `.aidd/conventions.md` |
| **Результат** | ЦП | `ai-docs/docs/reports/review-report.md` |

---

### Этап 6: QA Pipeline

| Параметр | Значение |
|----------|----------|
| **Команда** | `/test` |
| **Агент** | QA |
| **Предусловия** | `REVIEW_OK` |
| **Качественные ворота** | `QA_PASSED` |

#### Входные артефакты

| Артефакт | Источник | Путь |
|----------|----------|------|
| Код сервисов | ЦП | `services/` |
| PRD | ЦП | `ai-docs/docs/prd/{name}-prd.md` |

#### Выходные артефакты

| Артефакт | Путь в ЦП |
|----------|-----------|
| Отчёт QA | `ai-docs/docs/reports/qa-report.md` |

#### Критерии ворот QA_PASSED

| Критерий | Требование |
|----------|------------|
| Тесты | Все проходят |
| Coverage | >= 75% |
| Баги | Нет Critical/Blocker |

#### Источники файлов

| Файл | Источник | Путь |
|------|----------|------|
| Инструкции команды | Фреймворк | `.aidd/.claude/commands/test.md` |
| Инструкции агента | Фреймворк | `.aidd/.claude/agents/qa.md` |
| Детальные инструкции | Фреймворк | `.aidd/roles/qa/*.md` |
| База знаний | Фреймворк | `.aidd/knowledge/quality/testing.md` |
| **Результат** | ЦП | `ai-docs/docs/reports/qa-report.md` |

---

### Этап 7: Validation Pipeline

| Параметр | Значение |
|----------|----------|
| **Команда** | `/validate` |
| **Агент** | Валидатор |
| **Предусловия** | `QA_PASSED` |
| **Качественные ворота** | `ALL_GATES_PASSED` |

#### Входные артефакты

| Артефакт | Источник | Путь |
|----------|----------|------|
| Все артефакты | ЦП | `ai-docs/docs/` |
| Весь код | ЦП | `services/` |
| Состояние | ЦП | `.pipeline-state.json` |

#### Выходные артефакты

| Артефакт | Путь в ЦП |
|----------|-----------|
| Отчёт валидации | `ai-docs/docs/reports/validation-report.md` |
| RTM | `ai-docs/docs/rtm.md` |

#### Источники файлов

| Файл | Источник | Путь |
|------|----------|------|
| Инструкции команды | Фреймворк | `.aidd/.claude/commands/validate.md` |
| Инструкции агента | Фреймворк | `.aidd/.claude/agents/validator.md` |
| Детальные инструкции | Фреймворк | `.aidd/roles/validator/*.md` |
| Шаблон RTM | Фреймворк | `.aidd/templates/documents/rtm-template.md` |
| **Результат** | ЦП | `ai-docs/docs/reports/validation-report.md`, `ai-docs/docs/rtm.md` |

---

### Этап 8: Deploy Pipeline

| Параметр | Значение |
|----------|----------|
| **Команда** | `/deploy` |
| **Агент** | Валидатор |
| **Предусловия** | `ALL_GATES_PASSED` |
| **Качественные ворота** | `DEPLOYED` |

#### Входные артефакты

| Артефакт | Источник | Путь |
|----------|----------|------|
| Docker Compose | ЦП | `docker-compose.yml` |
| Makefile | ЦП | `Makefile` |
| Сервисы | ЦП | `services/` |

#### Действия

| # | Команда | Описание |
|---|---------|----------|
| 1 | `make build` | Сборка образов |
| 2 | `make up` | Запуск контейнеров |
| 3 | `make health` | Проверка health-check |
| 4 | `make logs` | Проверка логов |

#### Источники файлов

| Файл | Источник | Путь |
|------|----------|------|
| Инструкции команды | Фреймворк | `.aidd/.claude/commands/deploy.md` |
| Инструкции агента | Фреймворк | `.aidd/.claude/agents/validator.md` |
| База знаний | Фреймворк | `.aidd/knowledge/infrastructure/docker.md` |
| **Результат** | ЦП | Запущенные контейнеры |

---

## Сводная таблица пайплайнов

| # | Этап | Команда | Агент | Ворота | Выходной артефакт |
|---|------|---------|-------|--------|-------------------|
| 0 | Bootstrap | `/init` | — | `BOOTSTRAP_READY` | Структура ЦП |
| 1 | Идея | `/idea` | Аналитик | `PRD_READY` | PRD документ |
| 2 | Исследование | `/research` | Исследователь | `RESEARCH_DONE` | (в памяти) |
| 3 | Архитектура | `/plan` | Архитектор | `PLAN_APPROVED` | План архитектуры |
| 3 | Архитектура | `/feature-plan` | Архитектор | `PLAN_APPROVED` | План фичи |
| 4 | Реализация | `/generate` | Реализатор | `IMPLEMENT_OK` | Код сервисов |
| 5 | Ревью | `/review` | Ревьюер | `REVIEW_OK` | Отчёт ревью |
| 6 | QA | `/test` | QA | `QA_PASSED` | Отчёт QA |
| 7 | Валидация | `/validate` | Валидатор | `ALL_GATES_PASSED` | RTM, отчёт |
| 8 | Деплой | `/deploy` | Валидатор | `DEPLOYED` | Приложение |

---

## Матрица источников файлов

| Категория | Источник | Примеры путей |
|-----------|----------|---------------|
| **Инструкции команд** | Фреймворк | `.aidd/.claude/commands/*.md` |
| **Инструкции агентов** | Фреймворк | `.aidd/.claude/agents/*.md` |
| **Детальные роли** | Фреймворк | `.aidd/roles/*/*.md` |
| **Шаблоны документов** | Фреймворк | `.aidd/templates/documents/*.md` |
| **Шаблоны сервисов** | Фреймворк | `.aidd/templates/services/*/` |
| **Шаблоны инфраструктуры** | Фреймворк | `.aidd/templates/infrastructure/*/` |
| **База знаний** | Фреймворк | `.aidd/knowledge/*/*.md` |
| **Conventions** | Фреймворк | `.aidd/conventions.md` |
| **Workflow** | Фреймворк | `.aidd/workflow.md` |
| **PRD** | ЦП | `ai-docs/docs/prd/*.md` |
| **Планы** | ЦП | `ai-docs/docs/architecture/*.md`, `ai-docs/docs/plans/*.md` |
| **Отчёты** | ЦП | `ai-docs/docs/reports/*.md` |
| **RTM** | ЦП | `ai-docs/docs/rtm.md` |
| **Код сервисов** | ЦП | `services/*/` |
| **Инфраструктура** | ЦП | `docker-compose.yml`, `Makefile`, `nginx/` |
| **Состояние** | ЦП | `.pipeline-state.json` |

---

## См. также

- [workflow.md](../workflow.md) — Детальное описание процесса
- [initialization.md](initialization.md) — Алгоритм инициализации
- [INDEX.md](INDEX.md) — Индекс файлов фреймворка
- [NAVIGATION.md](NAVIGATION.md) — Навигационная матрица

---

**Версия**: 1.0
**Создан**: 2025-12-21
**Назначение**: Полная карта пайплайнов AIDD-MVP Generator
